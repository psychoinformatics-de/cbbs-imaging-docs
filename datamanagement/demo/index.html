<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="author" content="Team Brawndo" />
  <title>CBBS Imaging &ndash; Demo Study</title>
  <link rel="license" hreflang="en" href="../../copyright.html" />

  <link rel="stylesheet" type="text/css" href="../../theme/css/style.css">
</head>

<body>
  <aside>
    <h1><a href="/">CBBS Imaging</a></h1>
    <nav>
      <ul>

              <li>
                <a href="../../datamanagement/">Data Management</a>

                <ul>
                  <li>
                    <a href="../../datamanagement/study_setup/">Initial study setup</a>
                  </li>
                  <li>
                    <a href="../../datamanagement/import_dicoms/">Import DICOMs</a>
                  </li>
                  <li>
                    <a href="../../datamanagement/import_other/">Import additional data</a>
                  </li>
                  <li>
                    <a href="../../datamanagement/study_specification/">Study specification</a>
                  </li>
                  <li>
                    <a href="../../datamanagement/conversion/">Raw Data Conversion</a>
                  </li>
                  <li>
                    <a class="active" href="../../datamanagement/demo/">Demo Study</a>
<div id="toc"><ul><li><a class="toc-href" href="#creating-a-raw-dataset" title="Creating a raw dataset">Creating a raw dataset</a></li><li><a class="toc-href" href="#acquiring-data" title="Acquiring data">Acquiring data</a></li><li><a class="toc-href" href="#editing-the-specification" title="Editing the specification">Editing the specification</a></li><li><a class="toc-href" href="#conversion-to-bids" title="Conversion to BIDS">Conversion to BIDS</a></li></ul></div>                  </li>
                  <li>
                    <a href="../../datamanagement/demo_scandb/">Demo: DICOM DB</a>
                  </li>
                  <li>
                    <a href="../../datamanagement/tools/">Tools</a>
                  </li>
                </ul>
              </li>
              <li><a href="../../analysis/">Data Analysis</a></li>
              <li><a href="../../devices/">Acquisition Hardware</a></li>
              <li><a href="../../containers/">Computational Environments</a></li>
              <li><a href="../../contributing/">Contributing</a></li>
      </ul>
    </nav>
    <form class="searchbox" action="../../search.html">
      <input type="text" name="q" id="tipue_search_input" placeholder="Search">
    </form>
    <img src="../../theme/img/cbbs_logo.png" alt="CBBS Logo">
    <img src="../../theme/img/EFRE_logo.png"
         alt="Signets of Saxony-Anhalt and the European Regional Development Fund">
  </aside>

  <main>
    <div id='content'>
<article>
  <header>
    <nav>
      <ul class="breadcrumbs">
        <li><a href="../../">Home</a></li>
        <li> > <a href="../../datamanagement/">Data Management</a></li>
        <li> > Demo Study</li>
      </ul>
    </nav>
    <h1>Demo Study</h1>
  </header>

  <div>
    <p class="todo"><strong>TODO</strong>: title and introductory description of what this is about*</p>
<div class="section" id="creating-a-raw-dataset">
<h2 id="creating-a-raw-dataset">Creating a raw dataset<a class="headerlink" href="#creating-a-raw-dataset" title="Permalink to this headline"><i class="icon-link"></i></a></h2>
<p>First off, we need a study raw dataset to bundle all raw data in a structured way:</p>
<pre class="literal-block">
datalad create my_raw_dataset
cd my_raw_dataset
datalad run-procedure setup_study_dataset
</pre>
<p class="todo"><strong>TODO</strong>: Already start editing study metadata here?</p>
<p>From within the dataset add our toolbox by calling:</p>
<pre class="literal-block">
datalad install --dataset . --source https://github.com/psychoinformatics-de/cbbs-toolbox.git code/toolbox
</pre>
</div>
<div class="section" id="acquiring-data">
<h2 id="acquiring-data">Acquiring data<a class="headerlink" href="#acquiring-data" title="Permalink to this headline"><i class="icon-link"></i></a></h2>
<p>From the scanner, we'd usually get a tarball containing the DICOMs of an acquisition. For this demo we can get such a tarball via:</p>
<pre class="literal-block">
wget https://github.com/datalad/example-dicom-functional/archive/half.tar.gz
</pre>
<p><em>TODO: acquisition ID, since DICOM contains subject ID only, which would become the acquisition ID as well</em>
Now, as soon as we have an acquisition's data, we import it into the raw dataset
to make sure, we get its metadata as well as the correct starting point for the
data versioning.
From within the <tt class="docutils literal">my_raw_dataset</tt> directory we run:</p>
<pre class="literal-block">
datalad hirni-import-dcm /path/to/downloaded/half.tar.gz
</pre>
<p class="todo"><strong>TODO</strong>: Note on ReproIn Convention (<a class="reference external" href="https://github.com/repronim/reproin#overall-workflow">https://github.com/repronim/reproin#overall-workflow</a>)</p>
<p class="todo"><strong>TODO</strong>: Import of additional data</p>
</div>
<div class="section" id="editing-the-specification">
<h2 id="editing-the-specification">Editing the specification<a class="headerlink" href="#editing-the-specification" title="Permalink to this headline"><i class="icon-link"></i></a></h2>
<p>This step isn't actually required in case of this example. However, if there was
a need to change the specification of the study (or a single acquisition), you
can either edit the JSON files directly or use the WebUI:</p>
<pre class="literal-block">
% datalad webapp --dataset . hirni
</pre>
<p>Output ends with:</p>
<pre class="literal-block">
* Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
</pre>
<p>Now this address can be opened in a browser and should look like this:</p>
<img alt="" src="/theme/img/webui_index.png"/>
<p>Click on "Edit acquisition metadata" and select acquisition "02" to get to the
editing mask for this acquisition:</p>
<img alt="" src="/theme/img/webui_edit_acq.png"/>
<p>You can also edit more general information about the study, if you choose to
edit study metadata:</p>
<img alt="" src="/theme/img/webui_edit_study.png"/>
</div>
<div class="section" id="conversion-to-bids">
<h2 id="conversion-to-bids">Conversion to BIDS<a class="headerlink" href="#conversion-to-bids" title="Permalink to this headline"><i class="icon-link"></i></a></h2>
<p>In order to get a BIDS dataset from the raw dataset, create a new dataset and
set it up to become a BIDS dataset:</p>
<pre class="literal-block">
datalad create bids
cd bids
datalad run-procedure setup_bids_dataset
</pre>
<p>Now, install input data as a subdataset:</p>
<pre class="literal-block">
datalad install --dataset . --source ../study_ds sourcedata
datalad install sourcedata/code/toolbox
</pre>
<p>If the specification wasn't altered, the actual conversion is done by:</p>
<pre class="literal-block">
datalad hirni-spec2bids sourcedata/02/studyspec.json
</pre>
<p>Note, that this command takes a list of specification files (each expected to be
an acquisition specification) and converts the respective acquisitions. If you
want to convert a dataset with multiple acquisitions at once, just use:</p>
<pre class="literal-block">
datalad hirni-spec2bids sourcedata/*/studyspec.json
</pre>
</div>

  </div>
</article>
    </div>

    <footer>
      <p><small>
          Acknowledgment: funded by the federal state of Saxony-Anhalt and the "European Regional Development Fund" (ERDF 2014-2020), Project: Center for Behavioral Brain Sciences (CBBS), FKZ: ZS/2016/04/78113
      </small></p>
      <p><small>
        content licensed <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">cc-by-sa</a>
        <span class='break'>—</span> ©2017–2018 Team Brawndo <span class='break'>—</span>
        unless <a rel="license" href='../../copyright.html'>indicated otherwise</a>
      </small></p>
    </footer>
  </main>
</body>
</html>